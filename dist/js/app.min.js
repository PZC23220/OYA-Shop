$(function(){var a=(new Swiper(".swiper-container",{width:window.innerWidth,pagination:".swiper-pagination",autoplay:3e3,paginationClickable:!0,loop:!0}),new Swiper(".container",{speed:500,onSlideChangeStart:function(){$(".ul-li .active").removeClass("active"),$(".ul-li li").eq(a.activeIndex).addClass("active")}}));$(".ul-li li").on("touchstart mousedown",function(t){t.preventDefault(),$(".tabs .active").removeClass("active"),$(this).addClass("active"),a.slideTo($(this).index())}),$(".ul-li li").click(function(a){a.preventDefault()});var t=($("ul.ul-li").find("li"),$(".goods"),$(".comment-list"),$(".payMethod"));localStorage.getItem("count")?(total=JSON.parse(localStorage.getItem("count")),$(".num").html(JSON.parse(localStorage.getItem("count")))):total=parseInt($(".num").html()),t.on("singleTap",function(){var a,t={};if(localStorage.getItem("shoppingCar")){a=JSON.parse(localStorage.getItem("shoppingCar"));for(var e=0;e<a.length;e++)if(a[e].title==$(".xinxi").find(".namee").html()){a[e].count=a[e].count+1;break}e>a.length-1&&(t={title:$(".xinxi").find(".namee").html(),img:$(".swiper-wrapper").find("img").eq(0).attr("src"),price:$(".xinxi").find(".price i").html(),count:1},total++,$(".num").html(total),a.push(t))}else a=[],t={title:$(".xinxi").find(".namee").html(),img:$(".swiper-wrapper").find("img").eq(0).attr("src"),price:$(".xinxi").find(".price i").html(),count:1},total++,$(".num").html(total),a.push(t);a=JSON.stringify(a),localStorage.setItem("shoppingCar",a),localStorage.setItem("count",total)})}),$(function(a){var t=(new Swiper(".swiper-container",{width:window.innerWidth,pagination:".swiper-pagination",autoplay:3e3,paginationClickable:!0,loop:!0}),a(".fix").eq(1));a.ajaxSetup({url:"data/products.json",dataType:"json",success:function(e){a.each(e,function(e,n){var i=a("<div/>").addClass("products"),l=a("<div/>").addClass("col-xs-12"),o=a("<a/>").attr("href",n.href),s=a("<img/>").attr("src",n.img);o.append(s),l.append(o),i.append(l);var p=a("<div/>").addClass("pro-title").html(n.title);i.append(p);var d=a("<strong/>").addClass("price").html("&yen;"+n.price);i.append(d),t.append(i)})}}),a.ajax();var e=0;a(window).on("scroll",function(){var t=a(window).scrollTop();t>=a(document).height()-a(window).height()-100&&(e++,e<4&&a.ajax()),t>=300?a(".scroll_top").show():a(".scroll_top").hide()}),a(".scroll_top").on("click",function(){a("html,body").animate({scrollTop:0})})}),$(function(){var a=$(".list-brand li"),t=$("ul.allUl");$(".list-Img");a.on("singleTap",function(){$(this).index();$(this).addClass("active").siblings().removeClass("active")});var e=0;a.on("singleTap",function(){$.ajaxSetup({url:"../data/liebiao1.json",type:"get",dataType:"json",async:!0,success:function(a){t.eq(0).find("img").attr({src:a[e].imgurl}),t.eq(0).find("p").text(a[e].name),t.eq(1).find("img").attr({src:a[e+1].imgurl}),t.eq(1).find("p").text(a[e+1].name),e++,e>=a.length-1&&(e=0)}}),$.ajax()})}),$(function(a){var t=a("input"),e=a(".txt"),n=a("#sheng"),i=a("#shenglist"),l=a("#shi"),o=a("#shilist"),s=a("#xian"),p=a("#xianlist"),d=a("#title"),c=JSON.parse(localStorage.getItem("data"));c&&(d.html("我的资料"),t.eq(0).val(c.name),t.eq(1).val(c.phone),t.eq(2).val(c.sheng),t.eq(3).val(c.shi),t.eq(4).val(c.xian),t.eq(5).val(c.dress)),t.eq(0).on("blur",function(){var a=t.eq(0).val();if(""==a)e.html("昵称不能为空！");else{var n=/^.{2,10}/,i=n.test(a);i?e.html(""):t.eq(1).val("")}}),t.eq(1).on("blur",function(){var a=t.eq(1).val();if(""==a)e.html("填写手机号。");else{var n=/^(134|155|180|150|138|156)\d{8}$/,i=n.test(a);i?e.html(""):t.eq(1).val("")}}),a.ajax({url:"../data/region.json",dataType:"json",success:function(t){a.each(t,function(t,e){a.each(e,function(t,d){var c=a("<option/>");c.attr({value:d.name}).html(d.name).appendTo(i),l.on("focus",function(){var i=n.val();d.name==i&&(o.empty(),a.each(e[t].regions,function(t,e){var n=a("<option/>");n.attr({value:e.name}).html(e.name).appendTo(o),s.on("focus",function(){var t=l.val();e.name==t&&(p.empty(),a.each(e.regions,function(t,e){var n=a("<option/>");n.attr({value:e.name}).html(e.name).appendTo(p)}))})}))})})})}});var r={};t.eq(6).on("singleTap",function(){""==t.eq(0).val()||""==t.eq(1).val()||""==t.eq(2).val()||""==t.eq(3).val()||""==t.eq(4).val()||""==t.eq(5).val()?e.html("写完再走！"):(r.name=t.eq(0).val(),r.phone=t.eq(1).val(),r.sheng=t.eq(2).val(),r.shi=t.eq(3).val(),r.xian=t.eq(4).val(),r.dress=t.eq(5).val(),localStorage.setItem("data",JSON.stringify(r)),location.assign("zhongxin.html"))})}),$(function(a){var t=a(".list");a.ajaxSetup({url:"../data/list.json",dataType:"json",success:function(e){a.each(e,function(e,n){var i=a("<div/>").addClass("row-content"),l=a("<div/>").addClass("col-xs-3");l.html(n.income),i.append(l);var o=a("<div/>").addClass("col-xs-3");o.html(n.surplus),i.append(o);var s=a("<div/>").addClass("col-xs-3");s.html(n.remark),i.append(s);var p=a("<div/>").addClass("col-xs-3");p.html(n.time),i.append(p),t.append(i)})}}),a.ajax();var e=0;a(window).on("scroll",function(){var t=a(window).scrollTop();t>=a(document).height()-a(window).height()-100&&(e++,e<3&&a.ajax())})}),$(function(a){var t=a(".side-list"),e=a("#memu-list");e.on("singleTap",function(){t.fadeToggle()})}),$(function(a){function t(a,t){i=JSON.parse(localStorage.getItem("shoppingCar")),console.log(a);for(var e=0;e<i.length;e++)i[e].title==a&&(i[e].count=t,localStorage.setItem("shoppingCar",JSON.stringify(i)))}function e(){var t=0;g.each(function(){var e=a(this).closest("li");this.checked&&(t+=e.find(".price i").html()*e.find(".count").val())}),a("span",".pay").html(t)}var n=a(".dataList"),i=localStorage.getItem("shoppingCar");i=i?JSON.parse(i):[];for(var l=0;l<i.length;l++){var o=a("<li/>"),s=a("<div/>").addClass("choice col-xs-1");a('<input type="checkbox" class="che" />').appendTo(s),a("<span/>").appendTo(s),o.append(s);var p=a("<div/>").addClass("goods col-xs-2");$a=a("<a/>").attr("href","goods.html"),a("<img/>").attr("src",i[l].img).appendTo($a),$a.appendTo(p),p.appendTo(o);var d=a("<div/>").addClass("info col-xs-5"),c=a("<div/>").addClass("title");a("<p/>").html(i[l].title).appendTo(c),a("<span/>").addClass("price").html("&yen;<i>"+i[l].price+"</i>").appendTo(c),c.appendTo(d),d.appendTo(o);var r=a("<div/>").addClass("num col-xs-3");a('<input type="button" value="-" class="cut" />').appendTo(r),a('<input type="text" value='+i[l].count+" />").addClass("count").appendTo(r),a('<input type="button" value="+" class="add" />').appendTo(r),r.appendTo(o),a("<span/>").addClass("glyphicon glyphicon-trash del col-xs-1").appendTo(o),o.appendTo(n)}var h=a(".allPick .che"),g=a(".che",".choice").not(".allPick .che"),u=a(".dataList .che");h.singleTap(function(){g.prop("checked",h.prop("checked")),a(".che",".choice").filter(":checked").siblings("span").addClass("pic"),a(".che",".choice").not(":checked").siblings("span").removeClass("pic"),e()}),g.singleTap(function(){var t=g.filter(":checked");h.prop("checked",g.length==t.length),a(".che",".choice").filter(":checked").siblings("span").addClass("pic"),a(".che",".choice").not(":checked").siblings("span").removeClass("pic"),e()}),n.on("singleTap",".cut",function(){var n=a(this).siblings(".count").val(),i=a(this).closest("li").find(".che");1==n?a(this).siblings(".count").val(1):a(this).siblings(".count").val(--n),i.prop("checked")&&e();var l=a(this).closest("li").find(".title p").html();t(l,n)}),n.on("singleTap",".add",function(){var n=a(this).siblings(".count").val(),i=a(this).closest("li").find(".che");a(this).siblings(".count").val(++n),i.prop("checked")&&e();var l=a(this).closest("li").find(".title p").html();t(l,n)}),n.on("singleTap",".del",function(){var t=a(this).closest("li").find(".price i").html()*a(this).closest("li").find(".count").val();a(this).closest("li").remove(),i=JSON.parse(localStorage.getItem("shoppingCar")),u.each(function(e,n){if(n.checked){var i=a("span",".pay").html()-t;a("span",".pay").html(i)}});for(var e in i)if(i[e].title==a(this).closest("li").find(".title p").html()){i.splice(e,1),localStorage.setItem("shoppingCar",JSON.stringify(i));var n=JSON.parse(localStorage.getItem("count"));localStorage.setItem("count",--n)}});var v,m={},f=[],$={};a(".pay").on("touchend",function(){var t=0;alert("正在跳转!"),u.each(function(e,n){if(n.checked){$.title=a(this).closest("li").find(".title p").html(),$.price=a(this).closest("li").find(".title i").html(),$.img=a(this).closest("li").find(".goods img").attr("src"),$.count=a(this).closest("li").find(".count").val(),f.push($),t++,i=JSON.parse(localStorage.getItem("shoppingCar"));for(var l=0;l<i.length;l++)if(i[l].title==$.title){i.splice(l,1),localStorage.setItem("shoppingCar",JSON.stringify(i));var o=JSON.parse(localStorage.getItem("count"));localStorage.setItem("count",--o)}}}),localStorage.getItem("order")?(v=JSON.parse(localStorage.getItem("order")),m={id:parseInt(1e3*Math.random()),sum:t,goods:f},0!=m.sum&&v.push(m)):(v=[],m={id:parseInt(1e3*Math.random()),sum:t,goods:f},0!=m.sum&&v.push(m)),v=JSON.stringify(v);localStorage.setItem("order",v)}),a(".payMethod").singleTap(function(){a(".payment").show()}),a(".payment").on("singleTap",".del span",function(){a(this).closest(".payment").hide()})}),$(function(){var a=$(".DDsection"),t=JSON.parse(localStorage.getItem("order"));$.each(t,function(e,n){var i=$("<div></div>"),l=$("<div></div>");l.addClass("dingdan1_1");var o=$("<span></span>"),s=$("<span></span>");o.html("店铺 <i>"+n.id+"</i>"),s.html("交易成功"),o.addClass("span1"),s.addClass("span2"),l.addClass("dingdan1_1"),o.appendTo(l),s.appendTo(l),l.appendTo(i);var p=0;$.each(n.goods,function(a,t){var e=$("<div></div>");e.addClass("dingdan1_2");var n=$("<div></div>"),l=$("<div></div>"),o=$("<img />");o.attr("src",t.img),o.addClass("oimg"),n.addClass("dingdan1_2_1"),o.appendTo(n),n.appendTo(e);var s=$("<p></p>"),d=$("<span></span>"),c=$("<span></span>");s.html(t.title),d.html("&yen;"+t.price),c.html("&times;"+t.count),d.addClass("span3"),c.addClass("span4"),l.addClass("dingdan1_2_2"),s.appendTo(l),d.appendTo(l),c.appendTo(l),e.addClass("dingdan1_2"),l.appendTo(e),e.appendTo(i),p+=t.price*t.count});var d=$("<div></div>"),c=$("<div></div>"),r=$("<p></p>"),h=$("<b></b>"),g=$("<b></b>"),u=$("<span></span>");h.html(n.sum),g.html("件商品：合计 ￥"),u.html(p),r.addClass("hh3"),h.appendTo(r),g.appendTo(r),u.appendTo(r),r.appendTo(d);var u=$("<span></span>"),v=$("<button></button>"),m=$("<button></button>"),f=$("<button></button>");v.html("付款"),m.html("删除订单"),f.html("查看物流"),u.addClass("span5"),v.addClass("button1"),m.addClass("button2"),f.addClass("button1"),v.appendTo(u),m.appendTo(u),f.appendTo(u),u.appendTo(c),d.addClass("dingdan1_3"),c.addClass("dingdan1_4"),i.addClass("dingdan1"),d.appendTo(i),c.appendTo(i),i.appendTo(a),m.on("singleTap",function(){m.closest(i).remove();for(var a=0;a<t.length;a++)t[a].id==$(this).closest(".dingdan1").find(".dingdan1_1 i").html()&&(t.splice(a,1),localStorage.setItem("order",JSON.stringify(t)))})})}),$(function(a){var t=a("#ziliao"),e=localStorage.getItem("data");e?t.html("我的资料"):t.html("完善资料");var n=a(".headPic");n.on("singleTap","img",function(){var t=a(this);navigator.camera.getPicture(function(a){t.attr({src:a})},function(){alert("头像上传失败")},{quality:80})})});